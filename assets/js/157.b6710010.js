(window.webpackJsonp=window.webpackJsonp||[]).push([[157],{675:function(e,t,r){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.r(t),t.default={buildHeader:function(e){var t=this,r=[];this.getHeader(e,r,0,0);var n=Math.max.apply(Math,o(r.map((function(e){return e.length}))));return r.filter((function(e){return e.length<n})).forEach((function(e){return t.pushRowSpanPlaceHolder(e,n-e.length)})),r},getHeader:function(e,t,r,n){var o=0,a=t[r];a||(a=t[r]=[]),this.pushRowSpanPlaceHolder(a,n-a.length);for(var l=0;l<e.length;l++){var i=e[l];if(a.push(i.label),i.hasOwnProperty("children")&&Array.isArray(i.children)&&i.children.length>0){var c=this.getHeader(i.children,t,r+1,a.length-1);this.pushColSpanPlaceHolder(a,c-1),o+=c}else o++}return o},pushRowSpanPlaceHolder:function(e,t){for(var r=0;r<t;r++)e.push("!$ROW_SPAN_PLACEHOLDER")},pushColSpanPlaceHolder:function(e,t){for(var r=0;r<t;r++)e.push("!$COL_SPAN_PLACEHOLDER")},doMerges:function(e){for(var t=e.length,r=[],n=0;n<t;n++)for(var o=e[n],a=0,l=0;l<o.length;l++)"!$COL_SPAN_PLACEHOLDER"===o[l]?(o[l]=void 0,l+1===o.length&&r.push({s:{r:n,c:l-a-1},e:{r:n,c:l}}),a++):a>0&&l>a?(r.push({s:{r:n,c:l-a-1},e:{r:n,c:l-1}}),a=0):a=0;for(var i=e[0].length,c=0;c<i;c++)for(var u=0,s=0;s<t;s++)"!$ROW_SPAN_PLACEHOLDER"===e[s][c]?(e[s][c]=void 0,s+1===t&&r.push({s:{r:s-u,c:c},e:{r:s,c:c}}),u++):u>0&&s>u?(r.push({s:{r:s-u-1,c:c},e:{r:s-1,c:c}}),u=0):u=0;return r},aoa_to_sheet:function(e,t){for(var r={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!==e.length;++o)for(var a=0;a!==e[o].length;++a){n.s.r>o&&(n.s.r=o),n.s.c>a&&(n.s.c=a),n.e.r<o&&(n.e.r=o),n.e.c<a&&(n.e.c=a);var l={v:e[o][a]||"",s:{font:{name:"宋体",sz:11,color:{auto:1,rgb:"000000"},bold:!0},alignment:{wrapText:1,horizontal:"center",vertical:"center",indent:0}}};o<t&&(l.s.border={top:{style:"thin",color:{rgb:"EBEEF5"}},left:{style:"thin",color:{rgb:"EBEEF5"}},bottom:{style:"thin",color:{rgb:"EBEEF5"}},right:{style:"thin",color:{rgb:"EBEEF5"}}},l.s.fill={patternType:"solid",fgColor:{theme:3,tint:.3999755851924192,rgb:"F5F7FA"},bgColor:{theme:7,tint:.3999755851924192,rgb:"F5F7FA"}});var i=XLSX.utils.encode_cell({c:a,r:o});"number"==typeof l.v?l.t="n":"boolean"==typeof l.v?l.t="b":l.t="s",r[i]=l}return n.s.c<1e7&&(r["!ref"]=XLSX.utils.encode_range(n)),r},s2ab:function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!==e.length;++n)r[n]=255&e.charCodeAt(n);return t},excel:function(e){var t=this;return new Promise((function(r,a){var l,i={prop:[]};i.header=t.buildHeader(e.columns),i.title=e.title||(new Date).getTime(),function e(t){t.forEach((function(t){t.children?e(t.children):i.prop.push(t.prop)}))}(e.columns),i.data=e.data.map((function(e){return i.prop.map((function(t){var r,n=e[t];return r=n,(Array.isArray(r)?r[0]instanceof Object:r instanceof Object)&&(n=JSON.stringify(n)),n}))}));var c=i.header.length;(l=i.header).push.apply(l,o(i.data).concat([[]]));var u=t.doMerges(i.header),s=t.aoa_to_sheet(i.header,c);s["!merges"]=u,s["!freeze"]={xSplit:"1",ySplit:""+c,topLeftCell:"B"+(c+1),activePane:"bottomRight",state:"frozen"},s["!cols"]=[{wpx:165}];var f={SheetNames:[i.title],Sheets:{}};f.Sheets[i.title]=s;var p=XLSX.write(f,{bookType:"xlsx",bookSST:!1,type:"binary",cellStyles:!0});!function(e,t){"object"==n(e)&&e instanceof Blob&&(e=URL.createObjectURL(e));var r,o=document.createElement("a");o.href=e,o.download=t||"",window.MouseEvent?r=new MouseEvent("click"):(r=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(r)}(new Blob([t.s2ab(p)],{type:"application/octet-stream"}),i.title+".xlsx"),r()}))},xlsx:function(e){var t=window.XLSX;return new Promise((function(r,n){var o=new FileReader;o.onload=function(e){var n=function(e){for(var t="",r=0,n=10240;r<e.byteLength/n;++r)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(r*n,r*n+n)));return t+String.fromCharCode.apply(null,new Uint8Array(e.slice(r*n)))}(e.target.result),o=t.read(btoa(n),{type:"base64"}),a=o.SheetNames[0],l=o.Sheets[a],i=function(e){var r,n=[],o=t.utils.decode_range(e["!ref"]),a=o.s.r;for(r=o.s.c;r<=o.e.c;++r){var l=e[t.utils.encode_cell({c:r,r:a})],i="UNKNOWN "+r;l&&l.t&&(i=t.utils.format_cell(l)),n.push(i)}return n}(l),c=t.utils.sheet_to_json(l);r({header:i,results:c})},o.readAsArrayBuffer(e)}))}}}]).default},830:function(e,t,r){"use strict";r.r(t);r(286);var n=r(675),o=r.n(n),a={mounted:function(){this.$nextTick((function(){var e=document.getElementById("text");document.getElementById("button1").onclick=function(){var t={title:"文档标题",column:[{label:"复杂表头",prop:"header",children:[{label:"姓名",prop:"name"},{label:"年龄",prop:"sex"}]}],data:JSON.parse(e.value,null,4)};o.a.excel({title:t.title,columns:t.column,data:t.data})}}))}},l=r(29),i=Object(l.a)(a,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("button",{ref:"button",attrs:{id:"button1"}},[this._v("导出excel")]),this._v(" "),t("input",{attrs:{type:"file",onchange:"change(this)"}}),this._v(" "),t("div",{staticStyle:{height:"30px"}}),this._v(" "),t("textarea",{staticClass:"text",attrs:{id:"text"}},[this._v('      [{\n      "name": "张三",\n      "sex": "男"\n    }]\n')])])}),[],!1,null,null,null);t.default=i.exports}}]);